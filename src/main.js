const { BrowserWindow, ipcMain } = require('electron');
const models = require('./db/models/db');

const etiquetaDireita = JSON.stringify({

    "ETQ_INFO000":"^XA~TA000~JSN^LT0^MNW^MTT^PON^PMN^LH0,0^JMA^PR4,4~SD23^JUS^LRN^CI27^PA0,1,1,0^",
    "ETQ_INFO001":"XZ~DGR:GE738013.GRF,4368,24,hN0:::hH0A8J0hN0hH028J0hN0hH0AH8I0hH05K0hG02A8J0hN0Y0",
    "ETQ_INFO002":"HAHFEAH8U0A8J0Y0H5HFD54gH0W0BOFAg0W017NF4g0U0HAPFEAH8N0HAJ8I0U05RFD4O01D404J0T02B",
    "ETQ_INFO003":"SFHAN0BFE28J0T05UF4N07FD1K0S0BVFHE8K02IFB8J0S07WFCM075F5CJ0R0BYFAK02E2HF8J0R07F7I",
    "ETQ_INFO004":"F7IF7IF7IF7FCL0507FK0Q0BgGFH8I0AE8FE8J0Q05gGF4K0407DK0P02BgGFA8I02E2FEK0P017gHFK0",
    "ETQ_INFO005":"5074K0P0gJFE8H02E8F8K0P07gIFDJ040FL0O03gJFEI02E0FL0O07HF7IF7IF7IF7IF7IF7FDJ0507L0",
    "ETQ_INFO006":"N0AgKFEI0AE8F8K0N05gKF4J040FL0N0gLF8I02E2FL0N07gKFK0507L0M0AgKFE8I02E8F8K0M01gKFC",
    "ETQ_INFO007":"K040FL0M0BgKFAJ02E2FAK0M07HF7IF7IF7IF7IF7IF7HFL0517L0L0AgKFE8J0AJFH8I0L01gKFCL07I",
    "ETQ_INFO008":"FCJ0L0BgKFEK02JF8J0L07gKF4L0I15K0K02gLF8L080I8J0K01TFJDNFV0K03TFJABLFEV0K017F7IF7",
    "ETQ_INFO009":"IF7F75J0157F7HFDV0K0SFHAI80HABJFE8L0AIEH8I0K07QFD4M015IF4M07IFCJ0J02RFAN023HFEM02",
    "ETQ_INFO010":"JF8J0J017PF5P017FDN075F5K0J0BPFEH8P0BFE8L02EAFA8J0J01PFCS054N050FL0J0BPFAS038M02E",
    "ETQ_INFO011":"0FL0J07F7IF7IF7T01O0507L0J0PFE8S028M0AE8F8K0J07OFCgJ0407L0I02PFAgI02E0FL0I01OFDgK",
    "ETQ_INFO012":"0507L0I0BOFE8gI02E8F8K0I05OF4gK0407L0I0BOF8gJ02E0FL0I0HIF7IF5gL0507L0I0OFEgK0AE8F",
    "ETQ_INFO013":"8K0I07NFCgL0407L0H02OFAgK02E2FL0H017NFgM0507L0H03OF8gK02E8F8K0H01NFDgM050FL0H03NF",
    "ETQ_INFO014":"EgL02FAFA8J0H01IF7IF7CgM075F5K0H0BNFEgM0JFH8I0H07NF4gM05IFCJ0H0NFEgN03IF8J0H07NFg",
    "ETQ_INFO015":"N01I5K0H0NFE8gM0JA8J0H07MFCgW0H0NFEgN0H2M0H07F7IF7F4gN0H1M0H0OFgHEH8J0HFE8K0017gP",
    "ETQ_INFO016":"FCK07FCL002gQFAJ02IFL0017gPFCK075FL003gQF8J02EAF8K001gQFCK050FL003gQFAJ02E2FL001J",
    "ETQ_INFO017":"F7IF7IF7IF7IF7IF7IF7HFCK0507L003gQFH8I0AE8F8K001gQFCK0407L003gQFAJ02E2FL001gQF4K0",
    "ETQ_INFO018":"507L00BgQF8J02E8F8K001gQFCK040FL003gQFAJ02E0FL001HF7IF7IF7IF7IF7IF7IF7IF7CK0507L0",
    "ETQ_INFO019":"0BgQFH8I0AE8F8K001gQFCK040FL003gQFAJ02E2FL001gQFCK0507L00BgQF8J02EAFH8J001gQFCK05",
    "ETQ_INFO020":"1FL003gQFAJ02FBFB8J001JF7IF7IF7IF7IF7IF7IF7HFCK07HF7CJ003gQFH8I0AJFH8I001gQFCK0J5",
    "ETQ_INFO021":"4J003gQFAJ0H2A2A8J001gQF4T003gQF8K0K8J001gQFCT002gQFAK02IAK0017F7IF7FDgH5L017F7K0",
    "ETQ_INFO022":"H0NFEgHAH8J0JFH8I0H07MFCgN07H57CJ0H0NFEgM02FHAB8J0H07MFDgN05H01K0H0NFE8gL02EH838J",
    "ETQ_INFO023":"0H07NFgN04H01CJ0H0BNFAgL02EH03AJ0H07IF7IF74gM05H01CJ0H0BNFE8gK0AE80BH8I0H01NFCgM0",
    "ETQ_INFO024":"4H01CJ0H03NFEgL02EH038J0H01OFgM05H018J0H02OF8gK02E8038J0H01OF4gL04H01CJ0H02OFAgK0",
    "ETQ_INFO025":"2EH03AJ0I0H7IF7IF4gL05H01CJ0I0OFE8gJ0AE80BH8I0I07OFgL04H01CJ0I0BOF8gJ02EH038J0I01",
    "ETQ_INFO026":"OFCgK05H01K0I0BOFE8gI02EHAB8J0I01PFgK0J5CJ0I02PFAgI02JF8J0J07F7IF7IF4gJ07IFK0J0QF",
    "ETQ_INFO027":"8S0A8N0BIF8J0J07PF4S01O05IDK0J03PFAR02BAN02A2AK0J01QFR017CW0J03QFA8O0AHFE8M0AJ8J0",
    "ETQ_INFO028":"J01QFDP01IFN0404L0K0RFAN02BIFAL02JFAJ0K07HF7IF7IF7FN01H7HFCM0H7HFCJ0K0BSFEAI8ALFE",
    "ETQ_INFO029":"8K0AJFH8I0K01SFD4I057KFDM07DH5K0K03gLF8K02FAH2K0K017gKFM07CM0L0gLF8L0BE808J0L05gK",
    "ETQ_INFO030":"FCL01DM0L03gKFEL02FAL0L017HF7IF7IF7IF7IF7IF7HFM074L0M0gLF8L0BE8K0M07gKF4L01FL0M03",
    "ETQ_INFO031":"gKFAL02FAK0M01gKFDM05CK0N0gLF8L0BE8J0N07gKFM01FK0N0BgKF8L02F8J0N017HF7IF7IF7IF7IF",
    "ETQ_INFO032":"7IF7F4M07K0N0AgKFE8K02F8J0O05gJFDL01DK0O02gKFL0BEK0P07gIFDK0174K0P0BgIFH8J03F8K0P",
    "ETQ_INFO033":"017gGFDL05DL0Q0BgGFAL0BEL0Q057F7IF7IF7IF7IF7HF4L074L0Q0AgFEH8J02FH8K0R05YFCL01DM0",
    "ETQ_INFO034":"R02XFEAL03AM0S057VF4M07CM0S0AVFE8L02FIE8J0T057SFD4N07DHFCJ0U0BSFAN02JFAJ0U0157HF7",
    "ETQ_INFO035":"IF7HFD5P0J5K0V0APFEH8N0AHEAEH8I0W05OF4Q0J54J0V0H2ABKFIAQ0J2K0Y01K5gI0Y0H8A8AH8gH0",
    "ETQ_INFO036":"hN0~DGR:GE738012.GRF,1280,8,V0:::::::::K0F8O0K07CO0K0HF8N0K0HFCN0K0HFEN0K0IFN0K0I",
    "ETQ_INFO037":"F8M0:K0F3F8M0K0F0F8M0K0F878M0K0FC38M0K0HFB8M0K0IF8M0:K07HFCM0K03IFM0L07HF8L0K0E3H",
    "ETQ_INFO038":"FEL0K0F07FEL0K0FC3FEL0K0HF07EL0K0HF83EL0K0HFE0EL0K0IF82L0K0IF8M0:K0F3F8M0K0E0F8M0",
    "ETQ_INFO039":"K0F078M0K0FE38M0K0HF78M0I030IF8M0I0387HF8M0I038IF8M0I03CIF8M0I03HEHF8M0I03FE3F8M0",
    "ETQ_INFO040":"I03FE0F8M0I03HF03N0I03HFCO0I01IFO0J0IFCN0J01HFEN0K0IF8M0::K063F8M0K060F8M0K0F038M",
    "ETQ_INFO041":"0K0FE08M0K0HFO0K0HFCN0J01HFEN0J01IFN0J01IF8M0:J01E3F8M0J01E0F8M0J01F078M0K0FE38M0",
    "ETQ_INFO042":"K0HF78M0K0IF8M0:K07HF8M0K03HF8M0L0HF8M0K0E3F8M0K0F8F8M0J01FP0J01FH8N0J01F8CN0J01F",
    "ETQ_INFO043":"8FN0J01F0FN0J01F8F8M0J01E0FN0J01E0F8M0J01F07N0J01FC78M0J01HF78M0K0IF8M0:38I0IF8H0",
    "ETQ_INFO044":"6J018I01HF8H06J03CJ0HF8H0EJ01EJ03FH01EJ03FK0F807EJ01F8M0FEJ03FCM0FEJ01FCL01FEJ03F",
    "ETQ_INFO045":"EL07FEJ03HFL07FEJ03HF8J01HFEJ03HFCJ01HFEJ03HFEJ03HFEJ03IFJ07HFEJ03IF8I0IFEJ03IFCH",
    "ETQ_INFO046":"01IFEJ03IFEH03IFEJ03JFH07IFEJ03JF80JFEJ03JFC1JFEJ03JFE3JFEJ03KF7JFEJ03PFEJ03JFE3J",
    "ETQ_INFO047":"FEJ03JFC3JFEJ03JF80JFEJ03JFH0JFEJ03IFEH03IFEJ03IFCH03IFEJ03IF8H01IFEJ03IFJ0IFEJ03",
    "ETQ_INFO048":"HFEJ07HFEJ03HFEJ03HFEJ03HF8J01HFCJ03HF8J01HFEJ03HF8J01HFCJ03HF8J01HFEJ03HF8J01HFC",
    "ETQ_INFO049":"J03HF8J01HFEJ03HFK01HFCJ03HF8J01HFEJ03HF8J01HFCJ03HF8J01HFEJ01HF801801HFCJ00HF803",
    "ETQ_INFO050":"C01HF8J007F807C01HFK003F80HF01FEK001F81HF01FCK001F83HF81F8K0H0787HFC1FL0H038IFE1F",
    "ETQ_INFO051":"L0H039JF1CL0H01BJFD8L0I0KFDM0I07JFEM0I03JFEM0I01JFCM0J0JF8M0J07HFEN0J03HFCN0J03HF",
    "ETQ_INFO052":"8N0J01HFO0K0HFO0K07CO0K03CO0K01P0V0:",
    "ETQ_INFO053":"~DGR:GE738011.GRF,864,12,gJ0::::0H4R0H4M007F8",
    "ETQ_INFO054":"Q0FEM007FR07FM00HF8Q0FEM007FR0HFM007F8Q0FEM0",
    "ETQ_INFO055":"07FR07FM00HF8Q0FE8L007FR0HFM007F8Q0FE",
    "ETQ_INFO056":"M007FR07FM00HF8Q0FEM0",
    "ETQ_INFO057":"07FR0HFM007F8Q0FEM007FR07FM00HF8Q0FE8L007FR0HFM007FMAK0FEM00",
    "ETQ_INFO058":"7MFCJ01HFM00NFCJ0HFEM007MFK07HFM007LFE",
    "ETQ_INFO059":"J03HFEM007LFCJ01IFM00MF8J0IFE8L007LFK0JFM00",
    "ETQ_INFO060":"7KFEJ03IFEM007KFCJ03JFM00LF8J0JFEM007",
    "ETQ_INFO061":"KFK0KFM007JFEJ03JFEM007JFCJ03KFM00KF8J0KFE8L",
    "ETQ_INFO062":"007JFJ01LFM007IFEJ03KFEM00",
    "ETQ_INFO063":"7IFCJ07LFM00JF8J0LFEM007IFJ01MFM007HFEJ03LFEM007HFK07MF",
    "ETQ_INFO064":"M00IF8J0MFE8L007FCJ01NFM007FE",
    "ETQ_INFO065":"J03MFEM007FR0HFM00HF8Q0FEM007FR0HFM007F8Q0FEM007FR07",
    "ETQ_INFO066":"FM00HF8Q0FE8L007FR0HFM007F8Q0F",
    "ETQ_INFO067":"EM007FR07FM00HF8Q0FEM007FR0HFM007F8Q0FEM007FR07FM00",
    "ETQ_INFO068":"HF8Q0FE8L007FR0HFM007F8Q0FEM00H7R0H7M002A8Q0HAM0gJ0::::::",
    "ETQ_INFO069":"^XA^MMT^PW709^LL531^LS0^FPH,1^FT329,489^A0B,45,48^FH",
    "ETQ_INFO070":"^CI28^FD",
    "ETQ_INFO072":"^FS^CI27^FT676,321^A0B,50,53^FH",
    "ETQ_INFO073":"^CI28^FD",
    "ETQ_INFO074":"4166/2012",
    "ETQ_INFO075":"^FS^CI27^FT606,496^A0B,50,53^FH",
    "ETQ_INFO076":"^CI28^FD",
    "ETQ_INFO078":"^FS^CI27^FT606,365^A0B,50,53^FH",
    "ETQ_INFO079":"^CI28^FD",
    "ETQ_INFO081":"^FS^CI27^FT606,206^A0B,50,53^FH^\\CI28^FD",
    "ETQ_INFO082":"LAVRAS",
    "ETQ_INFO083":"^FS^CI27^FPH,1^FT257,503^A0B,48,46^FH",
    "ETQ_INFO084":"^CI28^FD",
    "ETQ_INFO086":"^FS^CI27^FT387,486^A0B,33,35^FH^CI28^FDGAS PRESSURIZED^FS^CI27^FT539,466^A0B,33",
    "ETQ_INFO087":",35^FH^CI28^FDMADE IN BRAZIL^FS^CI27^FT434,445^A0B,33,35^FH",
    "ETQ_INFO088":"^CI28^FDDO NOT OPEN^FS^CI27^BY3,3,118^FT551,68^BCI,,Y,N^FH^FD>;",
    "ETQ_INFO090":"^FS^FO17,258^XGR:GE738013.GRF,1,1^FS^FO452,269^",
    "ETQ_INFO091":"XGR:GE738012.GRF,1,1^FS^FO627,423^XGR:GE738011.GRF,1,1^FS^PQ1,0,1,Y^XZ^XA^IDR:GE7",
    "ETQ_INFO092":"38011.GRF",
    "ETQ_INFO093":"^FS^XZ^XA^IDR:G",
    "ETQ_INFO094":"E738012.GRF^FS^XZ^XA^IDR:",
    "ETQ_INFO095":"GE738013.GRF^FS^XZ"
    
    },null,2);

const etiquetaEsquerda = JSON.stringify({

    "ETQ_INFO000":"^XA~TA000~JSN^LT0^MNW^MTT^PON^PMN^LH0,0^JMA^PR4,4~SD23^JUS^LRN^CI27^PA0,1,1,0^XZ",
    "ETQ_INFO001":"~DGR:G7F68013.GRF,4368,24,hN0:::hH0A8J0hN0hH028J0hN0hH0AH8I0hH05K0hG02A8J0hN0Y0H",
    "ETQ_INFO002":"AHFEAH8U0A8J0Y0H5HFD54gH0W0BOFAg0W017NF4g0U0HAPFEAH8N0HAJ8I0U05RFD4O01D404J0T02B",
    "ETQ_INFO003":"SFHAN0BFE28J0T05UF4N07FD1K0S0BVFHE8K02IFB8J0S07WFCM075F5CJ0R0BYFAK02E2HF8J0R07F7",
    "ETQ_INFO004":"IF7IF7IF7IF7FCL0507FK0Q0BgGFH8I0AE8FE8J0Q05gGF4K0407DK0P02BgGFA8I02E2FEK0P017gHF",
    "ETQ_INFO005":"K05074K0P0gJFE8H02E8F8K0P07gIFDJ040FL0O03gJFEI02E0FL0O07HF7IF7IF7IF7IF7IF7FDJ050",
    "ETQ_INFO006":"7L0N0AgKFEI0AE8F8K0N05gKF4J040FL0N0gLF8I02E2FL0N07gKFK0507L0M0AgKFE8I02E8F8K0M01",
    "ETQ_INFO007":"gKFCK040FL0M0BgKFAJ02E2FAK0M07HF7IF7IF7IF7IF7IF7HFL0517L0L0AgKFE8J0AJFH8I0L01gKF",
    "ETQ_INFO008":"CL07IFCJ0L0BgKFEK02JF8J0L07gKF4L0I15K0K02gLF8L080I8J0K01TFJDNFV0K03TFJABLFEV0K01",
    "ETQ_INFO009":"7F7IF7IF7F75J0157F7HFDV0K0SFHAI80HABJFE8L0AIEH8I0K07QFD4M015IF4M07IFCJ0J02RFAN02",
    "ETQ_INFO010":"3HFEM02JF8J0J017PF5P017FDN075F5K0J0BPFEH8P0BFE8L02EAFA8J0J01PFCS054N050FL0J0BPFA",
    "ETQ_INFO011":"S038M02E0FL0J07F7IF7IF7T01O0507L0J0PFE8S028M0AE8F8K0J07OFCgJ0407L0I02PFAgI02E0FL",
    "ETQ_INFO012":"0I01OFDgK0507L0I0BOFE8gI02E8F8K0I05OF4gK0407L0I0BOF8gJ02E0FL0I0H7IF7IF5gL0507L0I",
    "ETQ_INFO013":"0OFEgK0AE8F8K0I07NFCgL0407L0H02OFAgK02E2FL0H017NFgM0507L0H03OF8gK02E8F8K0H01NFDg",
    "ETQ_INFO014":"M050FL0H03NFEgL02FAFA8J0H01IF7IF7CgM075F5K0H0BNFEgM0JFH8I0H07NF4gM05IFCJ0H0NFEgN",
    "ETQ_INFO015":"03IF8J0H07NFgN01I5K0H0NFE8gM0JA8J0H07MFCgW0H0NFEgN0H2M0H07F7IF7F4gN0H1M0H0OFgHEH",
    "ETQ_INFO016":"8J0HFE8K0017gPFCK07FCL002gQFAJ02IFL0017gPFCK075FL003gQF8J02EAF8K001gQFCK050FL003",
    "ETQ_INFO017":"gQFAJ02E2FL001JF7IF7IF7IF7IF7IF7IF7HFCK0507L003gQFH8I0AE8F8K001gQFCK0407L003gQFA",
    "ETQ_INFO018":"J02E2FL001gQF4K0507L00BgQF8J02E8F8K001gQFCK040FL003gQFAJ02E0FL001HF7IF7IF7IF7IF7",
    "ETQ_INFO019":"IF7IF7IF7CK0507L00BgQFH8I0AE8F8K001gQFCK040FL003gQFAJ02E2FL001gQFCK0507L00BgQF8J",
    "ETQ_INFO020":"02EAFH8J001gQFCK051FL003gQFAJ02FBFB8J001JF7IF7IF7IF7IF7IF7IF7HFCK07HF7CJ003gQFH8",
    "ETQ_INFO021":"I0AJFH8I001gQFCK0J54J003gQFAJ0H2A2A8J001gQF4T003gQF8K0K8J001gQFCT002gQFAK02IAK00",
    "ETQ_INFO022":"17F7IF7FDgH5L017F7K0H0NFEgHAH8J0JFH8I0H07MFCgN07H57CJ0H0NFEgM02FHAB8J0H07MFDgN05",
    "ETQ_INFO023":"H01K0H0NFE8gL02EH838J0H07NFgN04H01CJ0H0BNFAgL02EH03AJ0H07IF7IF74gM05H01CJ0H0BNFE",
    "ETQ_INFO024":"8gK0AE80BH8I0H01NFCgM04H01CJ0H03NFEgL02EH038J0H01OFgM05H018J0H02OF8gK02E8038J0H0",
    "ETQ_INFO025":"1OF4gL04H01CJ0H02OFAgK02EH03AJ0I0H7IF7IF4gL05H01CJ0I0OFE8gJ0AE80BH8I0I07OFgL04H0",
    "ETQ_INFO026":"1CJ0I0BOF8gJ02EH038J0I01OFCgK05H01K0I0BOFE8gI02EHAB8J0I01PFgK0J5CJ0I02PFAgI02JF8",
    "ETQ_INFO027":"J0J07F7IF7IF4gJ07IFK0J0QF8S0A8N0BIF8J0J07PF4S01O05IDK0J03PFAR02BAN02A2AK0J01QFR0",
    "ETQ_INFO028":"17CW0J03QFA8O0AHFE8M0AJ8J0J01QFDP01IFN0404L0K0RFAN02BIFAL02JFAJ0K07HF7IF7IF7FN01",
    "ETQ_INFO029":"H7HFCM0H7HFCJ0K0BSFEAI8ALFE8K0AJFH8I0K01SFD4I057KFDM07DH5K0K03gLF8K02FAH2K0K017g",
    "ETQ_INFO030":"KFM07CM0L0gLF8L0BE808J0L05gKFCL01DM0L03gKFEL02FAL0L017HF7IF7IF7IF7IF7IF7HFM074L0",
    "ETQ_INFO031":"M0gLF8L0BE8K0M07gKF4L01FL0M03gKFAL02FAK0M01gKFDM05CK0N0gLF8L0BE8J0N07gKFM01FK0N0",
    "ETQ_INFO032":"BgKF8L02F8J0N017HF7IF7IF7IF7IF7IF7F4M07K0N0AgKFE8K02F8J0O05gJFDL01DK0O02gKFL0BEK",
    "ETQ_INFO033":"0P07gIFDK0174K0P0BgIFH8J03F8K0P017gGFDL05DL0Q0BgGFAL0BEL0Q057F7IF7IF7IF7IF7HF4L0",
    "ETQ_INFO034":"74L0Q0AgFEH8J02FH8K0R05YFCL01DM0R02XFEAL03AM0S057VF4M07CM0S0AVFE8L02FIE8J0T057SF",
    "ETQ_INFO035":"D4N07DHFCJ0U0BSFAN02JFAJ0U0157HF7IF7HFD5P0J5K0V0APFEH8N0AHEAEH8I0W05OF4Q0J54J0V0",
    "ETQ_INFO036":"H2ABKFIAQ0J2K0Y01K5gI0Y0H8A8AH8gH0hN0~DGR:G7F68012.GRF,1280,8,V0:::::::::K0F8O0K",
    "ETQ_INFO037":"07CO0K0HF8N0K0HFCN0K0HFEN0K0IFN0K0IF8M0:K0F3F8M0K0F0F8M0K0F878M0K0FC38M0K0HFB8M0",
    "ETQ_INFO038":"K0IF8M0:K07HFCM0K03IFM0L07HF8L0K0E3HFEL0K0F07FEL0K0FC3FEL0K0HF07EL0K0HF83EL0K0HF",
    "ETQ_INFO039":"E0EL0K0IF82L0K0IF8M0:K0F3F8M0K0E0F8M0K0F078M0K0FE38M0K0HF78M0I030IF8M0I0387HF8M0",
    "ETQ_INFO040":"I038IF8M0I03CIF8M0I03HEHF8M0I03FE3F8M0I03FE0F8M0I03HF03N0I03HFCO0I01IFO0J0IFCN0J",
    "ETQ_INFO041":"01HFEN0K0IF8M0::K063F8M0K060F8M0K0F038M0K0FE08M0K0HFO0K0HFCN0J01HFEN0J01IFN0J01I",
    "ETQ_INFO042":"F8M0:J01E3F8M0J01E0F8M0J01F078M0K0FE38M0K0HF78M0K0IF8M0:K07HF8M0K03HF8M0L0HF8M0K",
    "ETQ_INFO043":"0E3F8M0K0F8F8M0J01FP0J01FH8N0J01F8CN0J01F8FN0J01F0FN0J01F8F8M0J01E0FN0J01E0F8M0J",
    "ETQ_INFO044":"01F07N0J01FC78M0J01HF78M0K0IF8M0:38I0IF8H06J018I01HF8H06J03CJ0HF8H0EJ01EJ03FH01E",
    "ETQ_INFO045":"J03FK0F807EJ01F8M0FEJ03FCM0FEJ01FCL01FEJ03FEL07FEJ03HFL07FEJ03HF8J01HFEJ03HFCJ01",
    "ETQ_INFO046":"HFEJ03HFEJ03HFEJ03IFJ07HFEJ03IF8I0IFEJ03IFCH01IFEJ03IFEH03IFEJ03JFH07IFEJ03JF80J",
    "ETQ_INFO047":"FEJ03JFC1JFEJ03JFE3JFEJ03KF7JFEJ03PFEJ03JFE3JFEJ03JFC3JFEJ03JF80JFEJ03JFH0JFEJ03",
    "ETQ_INFO048":"IFEH03IFEJ03IFCH03IFEJ03IF8H01IFEJ03IFJ0IFEJ03HFEJ07HFEJ03HFEJ03HFEJ03HF8J01HFCJ",
    "ETQ_INFO049":"03HF8J01HFEJ03HF8J01HFCJ03HF8J01HFEJ03HF8J01HFCJ03HF8J01HFEJ03HFK01HFCJ03HF8J01H",
    "ETQ_INFO050":"FEJ03HF8J01HFCJ03HF8J01HFEJ01HF801801HFCJ00HF803C01HF8J007F807C01HFK003F80HF01FE",
    "ETQ_INFO051":"K001F81HF01FCK001F83HF81F8K0H0787HFC1FL0H038IFE1FL0H039JF1CL0H01BJFD8L0I0KFDM0I0",
    "ETQ_INFO052":"7JFEM0I03JFEM0I01JFCM0J0JF8M0J07HFEN0J03HFCN0J03HF8N0J01HFO0K0HFO0K07CO0K03CO0K0",
    "ETQ_INFO053":"1P0V0:~DGR:G7F68011.GRF,864,12,gJ0::::0H4R0H4M007F8Q0FEM007FR07FM00HF8Q0FEM007FR",
    "ETQ_INFO054":"0HFM007F8Q0FEM007FR07FM00HF8Q0FE8L007FR0HFM007F8Q0FEM007FR07FM00HF8Q0FEM007FR0HF",
    "ETQ_INFO055":"M007F8Q0FEM007FR07FM00HF8Q0FE8L007FR0HFM007FMAK0FEM007MFCJ01HFM00NFCJ0HFEM007MFK",
    "ETQ_INFO056":"07HFM007LFEJ03HFEM007LFCJ01IFM00MF8J0IFE8L007LFK0JFM007KFEJ03IFEM007KFCJ03JFM00L",
    "ETQ_INFO057":"F8J0JFEM007KFK0KFM007JFEJ03JFEM007JFCJ03KFM00KF8J0KFE8L007JFJ01LFM007IFEJ03KFEM0",
    "ETQ_INFO058":"07IFCJ07LFM00JF8J0LFEM007IFJ01MFM007HFEJ03LFEM007HFK07MFM00IF8J0MFE8L007FCJ01NFM",
    "ETQ_INFO059":"007FEJ03M",
    "ETQ_INFO060":"FEM007FR0HFM00",
    "ETQ_INFO061":"HF8Q0FEM007FR0H",
    "ETQ_INFO062":"FM007F8Q0FEM007FR07",
    "ETQ_INFO063":"FM00HF8Q0FE8L007FR0HFM0",
    "ETQ_INFO064":"07F8Q0FEM007FR07",
    "ETQ_INFO065":"FM00HF8Q0FEM007",
    "ETQ_INFO066":"FR0HFM007F8Q0FEM007FR07",
    "ETQ_INFO067":"FM00HF8Q0FE8L007FR0HFM007F",
    "ETQ_INFO068":"8Q0FEM00H7R0H7M002A8Q0HAM0gJ0::::::",
    "ETQ_INFO069":"^XA^MMT^PW709^LL531^LS0^FT329,325^A0B,50,53^FH",
    "ETQ_INFO070":"^CI28^FD",
    "ETQ_INFO072":"^FS^CI27^FT676,321^A0B,50,53^FH",
    "ETQ_INFO073":"^CI28^FD",
    "ETQ_INFO074":"4166/2012",
    "ETQ_INFO075":"^FS^CI27^FT606,496^A0B,50,53^FH",
    "ETQ_INFO076":"^CI28^FD",
    "ETQ_INFO078":"^FS^CI27^FT606,365^A0B,50,53^FH",
    "ETQ_INFO079":"^CI28^FD",
    "ETQ_INFO081":"^FS^CI27^FT606,206^A0B,50,53^FH\\^CI28^FD",
    "ETQ_INFO082":"LAVRAS",
    "ETQ_INFO083":"^FS^CI27^FT254,339^A0B,50,53^FH",
    "ETQ_INFO084":"^CI28^FD",
    "ETQ_INFO086":"^FS^CI27^FT382,322^A0B,33,35^FH^CI28^FDGAS PRESSURIZED ^FS^CI27^FT534,302^A0B,33",
    "ETQ_INFO087":",35^FH^CI28^FDMADE IN BRAZIL^FS^CI27^FT429,281^A0B,33,35^FH",
    "ETQ_INFO088":"^CI28^FDDO NOT OPEN^FS^CI27^BY3,3,118^FT18,475^BCN,,Y,N^FH^FD>;",
    "ETQ_INFO090":"^FS^FO12,94^XGR:G7F68013.GRF,1,1^FS^FO447,105^XGR:G7F68012.GRF,1,1",
    "ETQ_INFO091":"^FS^FO627,423^XGR:G7F68011.GRF,1,1^FS",
    "ETQ_INFO092":"^PQ1,0,1,Y^XZ",
    "ETQ_INFO093":"^XA^IDR:G7F68011.GRF^FS^XZ",
    "ETQ_INFO094":"^XA^IDR:G7F68012.GRF^FS^XZ",
    "ETQ_INFO095":"^XA^IDR:G7F68013.GRF^FS^XZ"

    }, null, 2);

function cel3mc(idp, dados) {
    let query = `
    INSERT INTO "PART_NUMBER" ("id", "codigo", "nome", "estacao_inicial", "createdAt", "updatedAt", "estacao_final", "etiqueta_cliente", "cod_fornecedor")
    VALUES (${idp}, '${dados.codigo}', '${dados.nome}', 2, NOW(), NOW(), 9, '${dados.etq}', '${dados.cliente}');

    INSERT INTO "FLUXO" ("part_number", "estacao", "estacao_anterior", "createdAt", "updatedAt")
    VALUES (${idp}, 1, 0, NOW(), NOW()),
    (${idp}, 2, 1, NOW(), NOW()),
    (${idp}, 3, 2, NOW(), NOW()),
    (${idp}, 4, 3, NOW(), NOW()),
    (${idp}, 5, 4, NOW(), NOW()),
    (${idp}, 6, 4, NOW(), NOW()),
    (${idp}, 7, 6, NOW(), NOW()),
    (${idp}, 38, 7, NOW(), NOW());
    `
    return query
}
function cel6F(idp, dados) {
    let query = `
    INSERT INTO "PART_NUMBER" ("id", "codigo", "nome", "estacao_inicial", "createdAt", "updatedAt", "estacao_final", "etiqueta_cliente", "cod_fornecedor")
    VALUES (${idp}, '${dados.codigo}', '${dados.nome}', 2, NOW(), NOW(), 9, '${dados.etq}', '${dados.cliente}');

    INSERT INTO "FLUXO" ("part_number", "estacao", "estacao_anterior", "createdAt", "updatedAt")
    VALUES (${idp}, 2, 0, NOW(), NOW()),
    (${idp}, 4, 2, NOW(), NOW()),
    (${idp}, 6, 4, NOW(), NOW()),
    (${idp}, 8, 6, NOW(), NOW()),
    (${idp}, 10, 8, NOW(), NOW()),
    (${idp}, 40, 8, NOW(), NOW()),
    (${idp}, 9, 10, NOW(), NOW()),
    (${idp}, 9, 40, NOW(), NOW());

    SELECT setval('"RECEITA_id_seq"'::regclass, (SELECT MAX (id) FROM public."RECEITA"), true);

    INSERT INTO "RECEITA" ("part_number", "estacao", "dados_receita", "createdAt", "updatedAt")
    VALUES (${idp}, 2, '{}', NOW(), NOW()),
    (${idp}, 4, '{}', NOW(), NOW()),
    (${idp}, 6, '{}', NOW(), NOW()),
    (${idp}, 8, '{}', NOW(), NOW()),
    (${idp}, 10, '{}', NOW(), NOW()),
    (${idp}, 40, '{}', NOW(), NOW()),
    (${idp}, 9, '{}', NOW(), NOW());
    `
    return query
}

function cel8F(idp, dados) {
    let query = `
    INSERT INTO "PART_NUMBER" ("id", "codigo", "nome", "estacao_inicial", "createdAt", "updatedAt", "estacao_final", "etiqueta_cliente", "cod_fornecedor")
    VALUES (${idp}, '${dados.codigo}', '${dados.nome}', 0, NOW(), NOW(), 47, '${dados.etq}', '${dados.cliente}');

    INSERT INTO "FLUXO" ("part_number", "estacao", "estacao_anterior", "createdAt", "updatedAt")
    VALUES (${idp}, 41, 0, NOW(), NOW()),
    (${idp}, 42, 41, NOW(), NOW()),
    (${idp}, 43, 42, NOW(), NOW()),
    (${idp}, 44, 43, NOW(), NOW()),
    (${idp}, 45, 44, NOW(), NOW()),
    (${idp}, 46, 45, NOW(), NOW()),
    (${idp}, 47, 46, NOW(), NOW());

    SELECT setval('"RECEITA_id_seq"'::regclass, (SELECT MAX (id) FROM public."RECEITA"), true);

    INSERT INTO "RECEITA" ("part_number", "estacao", "dados_receita", "createdAt", "updatedAt")
    VALUES (${idp}, 41, '{}', NOW(), NOW()),
    (${idp}, 42, '{}', NOW(), NOW()),
    (${idp}, 43, '{}', NOW(), NOW()),
    (${idp}, 44, '{}', NOW(), NOW()),
    (${idp}, 45, '{}', NOW(), NOW()),
    (${idp}, 46, '{}', NOW(), NOW()),
    (${idp}, 47, '{}', NOW(), NOW());
    `
    return query;
}

function cel8ME(idp, dados) {
    if (dados.lado == "direito"){
        let query = `
        INSERT INTO "PART_NUMBER" ("id", "codigo", "nome", "estacao_inicial", "createdAt", "updatedAt", "estacao_final", "etiqueta_cliente", "cod_fornecedor")
        VALUES (${idp}, '${dados.codigo}', '${dados.nome}', 0, NOW(), NOW(), 27, '${dados.etq}', '${dados.cliente}');

        INSERT INTO "FLUXO" ("part_number", "estacao", "estacao_anterior", "createdAt", "updatedAt")
        VALUES (${idp}, 17, 0, NOW(), NOW()),
            (${idp}, 18, 17, NOW(), NOW()),
            (${idp}, 19, 18, NOW(), NOW()),
            (${idp}, 28, 19, NOW(), NOW()),
            (${idp}, 29, 19, NOW(), NOW()),
            (${idp}, 30, 28, NOW(), NOW()),
            (${idp}, 30, 29, NOW(), NOW()),
            (${idp}, 22, 30, NOW(), NOW()),
            (${idp}, 27, 22, NOW(), NOW());

        SELECT setval('"RECEITA_id_seq"'::regclass, (SELECT MAX (id) FROM public."RECEITA"), true);

        INSERT INTO "RECEITA" ("part_number", "estacao", "dados_receita", "createdAt", "updatedAt")
        VALUES (${idp}, 17, '${etiquetaDireita}', NOW(), NOW()),
               (${idp}, 18, '{"SIS_REC_LADOMAQUINA":"D"}', NOW(), NOW()),
               (${idp}, 19, '{"SIS_REC_LADOMAQUINA":"D"}', NOW(), NOW()),
               (${idp}, 24, '{"SIS_REC_LADOMAQUINA":"D"}', NOW(), NOW()),
               (${idp}, 28, '{"SIS_REC_LADOMAQUINA":"D"}', NOW(), NOW()),
               (${idp}, 29, '{"SIS_REC_LADOMAQUINA":"D"}', NOW(), NOW()),
               (${idp}, 30, '{"SIS_REC_LADOMAQUINA":"D"}', NOW(), NOW()),
               (${idp}, 22, '{"SIS_REC_LADOMAQUINA":"D"}', NOW(), NOW()),
               (${idp}, 27, '{"SIS_REC_LADOMAQUINA":"D"}', NOW(), NOW());
    `
        return query;
    } else { // monta para o lado esquerdo
        let query = `
        INSERT INTO "PART_NUMBER" ("id", "codigo", "nome", "estacao_inicial", "createdAt", "updatedAt", "estacao_final", "etiqueta_cliente", "cod_fornecedor")
        VALUES (${idp}, '${dados.codigo}', '${dados.nome}', 0, NOW(), NOW(), 27, '${dados.etq}', '${dados.cliente}');

        INSERT INTO "FLUXO" ("part_number", "estacao", "estacao_anterior", "createdAt", "updatedAt")
        VALUES (${idp}, 17, 0, NOW(), NOW()),
            (${idp}, 18, 17, NOW(), NOW()),
            (${idp}, 19, 18, NOW(), NOW()),
            (${idp}, 28, 19, NOW(), NOW()),
            (${idp}, 29, 19, NOW(), NOW()),
            (${idp}, 30, 28, NOW(), NOW()),
            (${idp}, 30, 29, NOW(), NOW()),
            (${idp}, 22, 30, NOW(), NOW()),
            (${idp}, 27, 22, NOW(), NOW());

        SELECT setval('"RECEITA_id_seq"'::regclass, (SELECT MAX (id) FROM public."RECEITA"), true);

        INSERT INTO "RECEITA" ("part_number", "estacao", "dados_receita", "createdAt", "updatedAt")
        VALUES (${idp}, 17, '${etiquetaEsquerda}', NOW(), NOW()),
               (${idp}, 18, '{"SIS_REC_LADOMAQUINA":"E"}', NOW(), NOW()),
               (${idp}, 19, '{"SIS_REC_LADOMAQUINA":"E"}', NOW(), NOW()),
               (${idp}, 24, '{"SIS_REC_LADOMAQUINA":"E"}', NOW(), NOW()),
               (${idp}, 28, '{"SIS_REC_LADOMAQUINA":"E"}', NOW(), NOW()),
               (${idp}, 29, '{"SIS_REC_LADOMAQUINA":"E"}', NOW(), NOW()),
               (${idp}, 30, '{"SIS_REC_LADOMAQUINA":"E"}', NOW(), NOW()),
               (${idp}, 22, '{"SIS_REC_LADOMAQUINA":"E"}', NOW(), NOW()),
               (${idp}, 27, '{"SIS_REC_LADOMAQUINA":"E"}', NOW(), NOW());
    `
    return query;
    };
}

function cel10ME(idp, dados) {
    let query = `
    INSERT INTO "PART_NUMBER" ("id", "codigo", "nome", "estacao_inicial", "createdAt", "updatedAt", "estacao_final", "etiqueta_cliente", "cod_fornecedor")
    VALUES (${idp}, '${dados.codigo}', '${dados.nome}', 0, NOW(), NOW(), 61, '${dados.etq}', '${dados.cliente}');
    
    INSERT INTO "FLUXO" ("part_number", "estacao", "estacao_anterior", "createdAt", "updatedAt")
    VALUES (${idp}, 56, 0, NOW(), NOW()),
           (${idp}, 55, 56, NOW(), NOW()),
           (${idp}, 57, 55, NOW(), NOW()),
           (${idp}, 58, 57, NOW(), NOW()),
           (${idp}, 59, 58, NOW(), NOW()),
           (${idp}, 60, 59, NOW(), NOW()),
           (${idp}, 61, 60, NOW(), NOW());
    
    SELECT setval('"RECEITA_id_seq"'::regclass, (SELECT MAX (id) FROM public."RECEITA"), true);

    INSERT INTO "RECEITA" ("part_number", "estacao", "dados_receita", "createdAt", "updatedAt")
    VALUES (${idp}, 55, '{"CAIXA_1_PN": "${dados.tpressao}"}', NOW(), NOW());
    `
};

function createWindow() {
    const win = new BrowserWindow({
                    width: 400,
                    height: 410,
                    webPreferences: {
                        nodeIntegration: true,
                        contextIsolation: false
                    }
                })
    win.loadFile('src/index.html');
}

ipcMain.on('new-pn', async (e, arg) => {
    
    try {
        let res = await models.Partnumber.findOne({
            attributes: ['id'],
            order: [['id', 'DESC']]
        })

        let idp = res.dataValues.id + 1;
        let query = "";
        let celulaAlvo = arg.celula;
        console.log(arg);
        switch (celulaAlvo) {
            case "Cel3mc":
                query = cel3mc(idp, arg)
                break;
            case "Cel6f":
                query = cel6F(idp, arg)
                break;
            case "Cel8f":
                query = cel8F(idp, arg)
                break;
            case "Cel8me":
                query = cel8ME(idp, arg)
                break;
            case "Cel10me":
                query = cel10ME(idp, arg)
                break;
        }
        
        const part = await models.db.query(query);
        e.reply("pnCreated", "Sucesso");
    } catch (error) {
        e.reply("pnCreated", 'Erro');
        console.log(error);
    }
})

module.exports = { createWindow }